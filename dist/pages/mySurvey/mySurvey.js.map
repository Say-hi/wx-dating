{"version":3,"sources":["pages/mySurvey/mySurvey.js"],"names":["app","getApp","useUrl","require","Page","data","title","topArr","page","topCur","orderArr","goDetail","e","that","wx","navigateTo","url","currentTarget","dataset","id","orderid","chooseTop","setData","index","getMySend","getMyReceive","obj","myReceiveQuestionnaires","session_key","getStorageSync","success","res","length","showToast","mask","concat","wxrequest","sendObj","myFachuQuestionnaires","onLoad","onReady","onShow","hide","onHide","onUnload","onPullDownRefresh","onReachBottom"],"mappings":"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","file":"mySurvey.js","sourcesContent":["// 获取全局应用程序实例对象\nconst app = getApp()\nconst useUrl = require('../../utils/service')\n// 创建页面实例对象\nPage({\n  /**\n   * 页面的初始数据\n   */\n  data: {\n    title: 'mySurvey',\n    topArr: [\n      '我收到的问卷',\n      '我发出的问卷'\n    ],\n    page: 1,\n    topCur: 0,\n    orderArr: [\n      // {\n      //   number: 6321654165,\n      //   img: 'http://img02.tooopen.com/images/20150928/tooopen_sy_143912755726.jpg',\n      //   title: 'Kiss Bottle 全新手工制甜品餐',\n      //   time: '2017.05.20 18:30',\n      //   address: '珠江新城',\n      //   money: '158',\n      //   status: 1\n      // },\n      // {\n      //   number: 6321654165,\n      //   img: 'http://img02.tooopen.com/images/20150928/tooopen_sy_143912755726.jpg',\n      //   title: 'Kiss Bottle 全新手工制甜品餐',\n      //   time: '2017.05.20 18:30',\n      //   address: '珠江新城',\n      //   money: '158',\n      //   status: 2\n      // },\n      // {\n      //   number: 6321654165,\n      //   status: 0\n      // }\n    ]\n  },\n  // 查看详情\n  goDetail (e) {\n    let that = this\n    // let status = e.currentTarget.dataset.status * 1\n    let topCur = this.data.topCur * 1\n    // if (status === 0) {\n    //   wx.navigateTo({\n    //     url: '../survey/survey?id=' + e.currentTarget.dataset.id + '&topCur=' + that.data.topCur + '&write=true' + '&orderId=' + e.currentTarget.dataset.orderid + '&type=' + e.currentTarget.dataset.type\n    //   })\n    // } else {\n    //   wx.navigateTo({\n    //     url: '../survey/survey?id=' + e.currentTarget.dataset.id + '&topCur=' + that.data.topCur + '&write=false' + '&orderId=' + e.currentTarget.dataset.orderid + '&type=' + e.currentTarget.dataset.type\n    //   })\n    // }\n    if (topCur === 1) {\n      wx.navigateTo({\n        url: '../survey/survey?id=' + e.currentTarget.dataset.id + '&topCur=' + that.data.topCur + '&write=true' + '&orderId=' + e.currentTarget.dataset.orderid\n      })\n    } else {\n      wx.navigateTo({\n        url: '../showsurvey/showsurvey?id=' + e.currentTarget.dataset.id + '&topCur=' + that.data.topCur + '&write=false' + '&orderId=' + e.currentTarget.dataset.orderid\n      })\n    }\n  },\n  // 选择顶部nav\n  chooseTop (e) {\n    this.setData({\n      orderArr: []\n    })\n    if (e.currentTarget.dataset.index * 1 === 1) {\n      this.getMySend(1)\n    } else {\n      this.getMyReceive(1)\n    }\n    this.setData({\n      topCur: e.currentTarget.dataset.index * 1,\n      page: 1\n    })\n  },\n  // 获取我收到的问卷\n  getMyReceive (page) {\n    let that = this\n    let obj = {\n      url: useUrl.myReceiveQuestionnaires,\n      data: {\n        session_key: wx.getStorageSync('session_key'),\n        page: page\n      },\n      success (res) {\n        // console.log(res)\n        if (res.data.data.length <= 0) {\n          return wx.showToast({\n            title: '没有更多内容啦',\n            mask: true\n          })\n        }\n        that.setData({\n          orderArr: that.data.orderArr.concat(res.data.data)\n        })\n      }\n    }\n    app.wxrequest(obj)\n  },\n  // 获取我发出的问卷\n  getMySend (page) {\n    let that = this\n    let sendObj = {\n      url: useUrl.myFachuQuestionnaires,\n      data: {\n        session_key: wx.getStorageSync('session_key'),\n        page: page\n      },\n      success (res) {\n        if (res.data.data.length <= 0) {\n          return wx.showToast({\n            title: '没有更多内容啦',\n            mask: true\n          })\n        }\n        that.setData({\n          orderArr: that.data.orderArr.concat(res.data.data)\n        })\n      }\n    }\n    app.wxrequest(sendObj)\n  },\n  /**\n   * 生命周期函数--监听页面加载\n   */\n  onLoad () {\n    // TODO: onLoad\n    this.getMyReceive(1)\n  },\n\n  /**\n   * 生命周期函数--监听页面初次渲染完成\n   */\n  onReady () {\n    // TODO: onReady\n  },\n\n  /**\n   * 生命周期函数--监听页面显示\n   */\n  onShow () {\n    if (this.data.hide) {\n      this.setData({\n        orderArr: [],\n        page: 1\n      })\n      if (this.data.topCur * 1 === 1) {\n        this.getMySend(1)\n      } else {\n        this.getMyReceive(1)\n      }\n    }\n    // TODO: onShow\n  },\n\n  /**\n   * 生命周期函数--监听页面隐藏\n   */\n  onHide () {\n    this.setData({\n      hide: true\n    })\n    // TODO: onHide\n  },\n\n  /**\n   * 生命周期函数--监听页面卸载\n   */\n  onUnload () {\n    // TODO: onUnload\n  },\n\n  /**\n   * 页面相关事件处理函数--监听用户下拉动作\n   */\n  onPullDownRefresh () {\n    this.setData({\n      orderArr: [],\n      page: 1\n    })\n    if (this.data.topCur * 1 === 1) {\n      this.getMySend(1)\n    } else {\n      this.getMyReceive(1)\n    }\n  },\n  // 触底刷新\n  onReachBottom () {\n    let that = this\n    if (this.data.topCur === 1) {\n      this.getMySend(++that.data.page)\n    } else {\n      this.getMyReceive(++that.data.page)\n    }\n  }\n})\n"]}