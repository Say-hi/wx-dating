{"version":3,"sources":["pages/userInfo/userInfo.js"],"names":["app","getApp","useUrl","require","Page","data","title","logins","videoSrc","videoCover","videoPlay","videoControls","autoplay","show","playStatus","objectFit","houseArr","showMoreBtn","showTaDeep","userInfos","btnText","disabled","invite","userPhotos","open_types","estimate","getUserDetail","id","that","getObj","url","ViewUserInformation","session_key","wx","getStorageSync","view_user_id","success","res","job","split","video_image","shenduziliao","setData","getPhone","getMyInfo","user","i","comment_list","v","content","length","asdfasdf","wxrequest","videodel","follow","obj","subscribeByUser","user_id","code","showToast","message","playVideo","video_url","s","getSystemInfoSync","ss","brand","parseInt","system","showModal","showCancel","confirm","playFinish","getobj","getUserInfoBySelf","compny","houseIndex","cart_house","likesSports","likes_sports","likesMovies","likes_movies","likesBooks","likes_books","phone","phoneNumber","onLoad","params","userId","type","wxlogin","onReady","onShow","onHide","onUnload","onPullDownRefresh","onReachBottom","onShareAppMessage","path","reLaunch"],"mappings":";;AAAA;AACA,IAAMA,MAAMC,QAAZ;AACA,IAAMC,SAASC,QAAQ,qBAAR,CAAf;AACA;AACAC,KAAK;AACH;;;AAGAC,QAAM;AACJC,WAAO,UADH;AAEJC,YAAQ,IAFJ;AAGJ;AACAC,cAAU,EAJN;AAKJC,gBAAY,8BALR;AAMJC,eAAW,uBANP;AAOJC,mBAAe,IAPX;AAQJC,cAAU,KARN;AASJC,UAAM,IATF;AAUJC,gBAAY,KAVR;AAWJC,eAAW,MAXP;AAYJ;AACA;AACAC,cAAU,CAAC,MAAD,EAAS,MAAT,EAAiB,MAAjB,EAAyB,MAAzB,EAAiC,MAAjC,CAdN;AAeJC,iBAAa,IAfT;AAgBJC,gBAAY,KAhBR;AAiBJC,eAAW,EAjBP;AAkBJ;AACAC,aAAS,KAnBL;AAoBJC,cAAU,KApBN;AAqBJ;AACAC,YAAQ,EAtBJ;AAuBJ;AACAC,gBAAY,EAxBR;AAyBJC,gBAAY,UAzBR;AA0BJ;AACAC,cAAU;AA3BN,GAJH;AAiCH;AACAC,eAlCG,yBAkCYC,EAlCZ,EAkCgB;AACjB;AACA,QAAIC,OAAO,IAAX;AACA,QAAIC,SAAS;AACXC,WAAK5B,OAAO6B,mBADD;AAEX1B,YAAM;AACJ2B,qBAAaC,GAAGC,cAAH,CAAkB,aAAlB,CADT;AAEJC,sBAAcR;AAFV,OAFK;AAMXS,aANW,mBAMFC,GANE,EAMG;AACZ;AACAA,YAAIhC,IAAJ,CAASA,IAAT,CAAciC,GAAd,GAAoBD,IAAIhC,IAAJ,CAASA,IAAT,CAAciC,GAAd,CAAkBC,KAAlB,CAAwB,GAAxB,EAA6B,CAA7B,CAApB;AACA;AACAF,YAAIhC,IAAJ,CAASA,IAAT,CAAc,aAAd,IAA+BgC,IAAIhC,IAAJ,CAASA,IAAT,CAAcmC,WAAd,GAA4BH,IAAIhC,IAAJ,CAASA,IAAT,CAAcmC,WAA1C,GAAwD,2BAAvF;AACA,YAAIH,IAAIhC,IAAJ,CAASA,IAAT,CAAcoC,YAAlB,EAAgC;AAC9Bb,eAAKc,OAAL,CAAa;AACXxB,wBAAY,IADD;AAEXD,yBAAa;AAFF,WAAb;AAID;AACDjB,YAAI2C,QAAJ,CAAaf,IAAb,EAAmBD,EAAnB;AACAC,aAAKgB,SAAL;AACAhB,aAAKc,OAAL,CAAa;AACXG,gBAAMR,IAAIhC,IAAJ,CAASA;AADJ,SAAb;AAGA,YAAIyC,IAAI,CAAR;AAhBY;AAAA;AAAA;;AAAA;AAiBZ,+BAAcT,IAAIhC,IAAJ,CAASA,IAAT,CAAc0C,YAA5B,8HAA0C;AAAA,gBAAjCC,CAAiC;;AACxC,gBAAIA,EAAEC,OAAF,CAAUC,MAAV,GAAmB,CAAvB,EAA0B;AACxBJ,kBAAI,CAAJ;AACA;AACD;AACF;AAtBW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAuBZ,YAAIA,MAAM,CAAV,EAAa;AACXlB,eAAKc,OAAL,CAAa;AACXS,sBAAU;AADC,WAAb;AAGD;AACF;AAlCU,KAAb;AAoCAnD,QAAIoD,SAAJ,CAAcvB,MAAd;AACD,GA1EE;;AA2EH;AACAwB,UA5EG,sBA4ES;AACV,SAAKX,OAAL,CAAa;AACX7B,YAAM;AADK,KAAb;AAGD,GAhFE;;AAiFH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAyC,QAnGG,oBAmGO;AACR;AACA,QAAI1B,OAAO,IAAX;AACA,QAAI2B,MAAM;AACRzB,WAAK5B,OAAOsD,eADJ;AAERnD,YAAM;AACJ2B,qBAAaC,GAAGC,cAAH,CAAkB,aAAlB,CADT;AAEJuB,iBAAS7B,KAAKvB,IAAL,CAAUwC,IAAV,CAAeY;AAFpB,OAFE;AAMRrB,aANQ,mBAMCC,GAND,EAMM;AACZ;AACA,YAAIA,IAAIhC,IAAJ,CAASqD,IAAT,KAAkB,GAAtB,EAA2B;AACzBzB,aAAG0B,SAAH,CAAa;AACXrD,mBAAO;AADI,WAAb;AAGAsB,eAAKF,aAAL,CAAmBE,KAAKvB,IAAL,CAAUsB,EAA7B;AACA;AACA;AACA;AACA;AACA;AACA;AACD,SAXD,MAWO;AACLM,aAAG0B,SAAH,CAAa;AACXrD,mBAAO+B,IAAIhC,IAAJ,CAASuD;AADL,WAAb;AAGD;AACF;AAxBO,KAAV;AA0BA5D,QAAIoD,SAAJ,CAAcG,GAAd;AACD,GAjIE;;AAkIH;AACAM,WAnIG,uBAmIU;AACX,QAAI,KAAKxD,IAAL,CAAUwC,IAAV,CAAeiB,SAAf,CAAyBZ,MAAzB,IAAmC,CAAvC,EAA0C;AACxC,aAAOjB,GAAG0B,SAAH,CAAa;AAClBrD,eAAO;AADW,OAAb,CAAP;AAGD;AACD,QAAIyD,IAAI9B,GAAG+B,iBAAH,EAAR;AACA,QAAIC,KAAK,KAAT;AACA;AACA,QAAIF,EAAEG,KAAF,KAAY,QAAZ,IAAwBC,SAASJ,EAAEK,MAAF,CAAS7B,KAAT,CAAe,GAAf,EAAoB,CAApB,CAAT,KAAoC,EAAhE,EAAoE;AAClE;AACA0B,WAAK,IAAL;AACAhC,SAAGoC,SAAH,CAAa;AACX/D,eAAO,MADI;AAEX2C,iBAAS,kBAFE;AAGXqB,oBAAY,KAHD;AAIXlC,eAJW,mBAIFC,GAJE,EAIG;AACZ,cAAIA,IAAIkC,OAAR,EAAiB;AACf;AACD;AACF;AARU,OAAb;AAUD;AACD,QAAI,CAACN,EAAL,EAAS;AACP,WAAKvB,OAAL,CAAa;AACX9B,kBAAU,IADC;AAEXC,cAAM,KAFK;AAGXC,oBAAY;AAHD,OAAb;AAKD;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACD,GAhLE;;AAiLH;AACA0D,YAlLG,wBAkLW;AACZ,SAAK9B,OAAL,CAAa;AACX9B,gBAAU,KADC;AAEXC,YAAM,IAFK;AAGXC,kBAAY;AAHD,KAAb;AAKD,GAxLE;;AAyLH;AACA8B,WA1LG,uBA0LU;AACX,QAAIhB,OAAO,IAAX;AACA,QAAI6C,SAAS;AACX3C,WAAK5B,OAAOwE,iBADD;AAEXrE,YAAM;AACJ2B,qBAAaC,GAAGC,cAAH,CAAkB,aAAlB;AADT,OAFK;AAKXE,aALW,mBAKFC,GALE,EAKG;AACZ,YAAIS,IAAIT,IAAIhC,IAAJ,CAASA,IAAjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAuB,aAAKc,OAAL,CAAa;AACX;AACA;AACA;AACA;AACA;AACA;AACAiC,kBAAQ7B,EAAE6B,MAPC;AAQXC,sBAAY9B,EAAE+B,UARH;AASXC,uBAAahC,EAAEiC,YATJ;AAUXC,uBAAalC,EAAEmC,YAVJ;AAWXC,sBAAYpC,EAAEqC,WAXH;AAYX;AACA;AACAC,iBAAOxD,KAAKvB,IAAL,CAAUgF,WAAV,IAAyB;AAdrB,SAAb;AAgBD;AA/BU,KAAb;AAiCArF,QAAIoD,SAAJ,CAAcqB,MAAd;AACD,GA9NE;;AA+NH;;;AAGAa,QAlOG,kBAkOKC,MAlOL,EAkOa;AACd,SAAK7C,OAAL,CAAa;AACXf,UAAI4D,OAAOC,MADA;AAEXC,YAAMF,OAAOE,IAAP,IAAe;AAFV,KAAb;AAIA,QAAIF,OAAOE,IAAP,KAAgB,KAApB,EAA2B;AACzBzF,UAAI0F,OAAJ,CAAY,KAAKhE,aAAjB,EAAgC6D,OAAOC,MAAvC;AACD,KAFD,MAEO;AACL,WAAK9D,aAAL,CAAmB6D,OAAOC,MAA1B;AACD;AACF,GA5OE;;AA6OH;;;AAGAG,SAhPG,qBAgPQ;AACT;AACD,GAlPE;;;AAoPH;;;AAGAC,QAvPG,oBAuPO;AACR;AACA;AACD,GA1PE;;;AA4PH;;;AAGAC,QA/PG,oBA+PO;AACR;AACD,GAjQE;;;AAmQH;;;AAGAC,UAtQG,sBAsQS;AACV;AACD,GAxQE;;;AA0QH;;;AAGA;AACAC,mBA9QG,+BA8QkB;AACnB;AACA;AACA;AACD,GAlRE;;AAmRH;AACAC,eApRG,2BAoRc;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACD,GA/RE;AAgSHC,mBAhSG,+BAgSkB;AACnB,SAAKvD,OAAL,CAAa;AACX+C,YAAM;AADK,KAAb;AAGA,WAAO;AACLnF,aAAO,WADF;AAEL4F,gDAAwC,KAAK7F,IAAL,CAAUsB,EAAlD,cAFK;AAGLS,aAHK,qBAGM;AACTH,WAAGkE,QAAH,CAAY;AACVrE,eAAK;AADK,SAAZ;AAGD;AAPI,KAAP;AASD;AA7SE,CAAL","file":"userInfo.js","sourcesContent":["// 获取全局应用程序实例对象\nconst app = getApp()\nconst useUrl = require('../../utils/service')\n// 创建页面实例对象\nPage({\n  /**\n   * 页面的初始数据\n   */\n  data: {\n    title: 'userInfo',\n    logins: true,\n    // 视屏\n    videoSrc: '',\n    videoCover: '../../images/video_cover.jpg',\n    videoPlay: '../../images/play.png',\n    videoControls: true,\n    autoplay: false,\n    show: true,\n    playStatus: false,\n    objectFit: 'Fill',\n    // 用户信息\n    // userDetail: ['单身', '20-28岁', '188cm', '广告行业'],\n    houseArr: ['暂无信息', '有房有车', '有房无车', '有车无房', '车房待购'],\n    showMoreBtn: true,\n    showTaDeep: false,\n    userInfos: {},\n    // 按钮文字\n    btnText: '+关注',\n    disabled: false,\n    // invite\n    invite: [],\n    // 相册\n    userPhotos: [],\n    open_types: 'navigate',\n    // 评价\n    estimate: []\n  },\n  // 获取用户的详细资料\n  getUserDetail (id) {\n    // console.log(id);\n    let that = this\n    let getObj = {\n      url: useUrl.ViewUserInformation,\n      data: {\n        session_key: wx.getStorageSync('session_key'),\n        view_user_id: id\n      },\n      success (res) {\n        // console.log(res)\n        res.data.data.job = res.data.data.job.split('-')[1]\n        // res.data.data.shenduziliao = false\n        res.data.data['video_image'] = res.data.data.video_image ? res.data.data.video_image : '../../images/login-bg.png'\n        if (res.data.data.shenduziliao) {\n          that.setData({\n            showTaDeep: true,\n            showMoreBtn: false\n          })\n        }\n        app.getPhone(that, id)\n        that.getMyInfo()\n        that.setData({\n          user: res.data.data\n        })\n        let i = 0\n        for (let v of res.data.data.comment_list) {\n          if (v.content.length > 0) {\n            i = 1\n            break\n          }\n        }\n        if (i === 0) {\n          that.setData({\n            asdfasdf: true\n          })\n        }\n      }\n    }\n    app.wxrequest(getObj)\n  },\n  // 去除视屏区域\n  videodel () {\n    this.setData({\n      show: true\n    })\n  },\n  // 显示更多\n  // showMore () {\n  //   let name = '李四' + Math.floor(Math.random() * 10)\n  //   let obj = {\n  //     src: 'http://img06.tooopen.com/images/20160818/tooopen_sy_175833047715.jpg',\n  //     name: name,\n  //     gender: 1,\n  //     text: '李四444'\n  //   }\n  //   this.data.estimate.push(obj)\n  //   this.data.estimate.push(obj)\n  //   this.data.estimate.push(obj)\n  //   let newestimate = this.data.estimate\n  //   this.setData({\n  //     estimate: newestimate\n  //   })\n  // },\n  // 关注\n  follow () {\n    // console.log(e)\n    let that = this\n    let obj = {\n      url: useUrl.subscribeByUser,\n      data: {\n        session_key: wx.getStorageSync('session_key'),\n        user_id: that.data.user.user_id\n      },\n      success (res) {\n        // console.log(res)\n        if (res.data.code === 200) {\n          wx.showToast({\n            title: '关注成功'\n          })\n          that.getUserDetail(that.data.id)\n          // that.data.user.isSubscribe = true\n          // that.setData({\n          //   btnText: '已关注',\n          //   disabled: true,\n          //   user: that.data.user\n          // })\n        } else {\n          wx.showToast({\n            title: res.data.message\n          })\n        }\n      }\n    }\n    app.wxrequest(obj)\n  },\n  // 播放视屏\n  playVideo () {\n    if (this.data.user.video_url.length <= 1) {\n      return wx.showToast({\n        title: '该用户未上传视频'\n      })\n    }\n    let s = wx.getSystemInfoSync()\n    let ss = false\n    // console.log(s)\n    if (s.brand === 'iPhone' && parseInt(s.system.split(' ')[1]) <= 10) {\n      // console.log(1)\n      ss = true\n      wx.showModal({\n        title: '视频播放',\n        content: '由于IOS版本较低，视频无法播放',\n        showCancel: false,\n        success (res) {\n          if (res.confirm) {\n            return\n          }\n        }\n      })\n    }\n    if (!ss) {\n      this.setData({\n        autoplay: true,\n        show: false,\n        playStatus: true\n      })\n    }\n    // if (ss) {\n    //   setTimeout(() => {\n    //     this.setData({\n    //       autoplay: true,\n    //       show: false,\n    //       playStatus: true\n    //     })\n    //   }, 1500)\n    // } else {\n    //   this.setData({\n    //     autoplay: true,\n    //     show: false,\n    //     playStatus: true\n    //   })\n    // }\n  },\n  // 视屏结束\n  playFinish () {\n    this.setData({\n      autoplay: false,\n      show: true,\n      playStatus: false\n    })\n  },\n  // 首先获取自己的资料\n  getMyInfo () {\n    let that = this\n    let getobj = {\n      url: useUrl.getUserInfoBySelf,\n      data: {\n        session_key: wx.getStorageSync('session_key')\n      },\n      success (res) {\n        let i = res.data.data\n        // let job1 = i.job.split('-') || '不限'\n        // let v1 = that.data.industryOne.indexOf(job1[0]) || 0\n        // let v2 = 0\n        // // console.log(that.data.industryTwo)\n        // if (v1 < 24) {\n        //   v2 = that.data.industryTwo[v1].indexOf(job1[1]) || 0\n        // }\n        // let vv = [v1, v2]\n        that.setData({\n          // name: i.name,\n          // genderCur: i.sex * 1 - 1,\n          // marryCur: i.ganqing,\n          // ageIndex: that.data.ageArr.indexOf(i.age),\n          // userHeight: i.user_height,\n          // value: vv,\n          compny: i.compny,\n          houseIndex: i.cart_house,\n          likesSports: i.likes_sports,\n          likesMovies: i.likes_movies,\n          likesBooks: i.likes_books,\n          // comment_list: i.comment_lists,\n          // id: i.user_id,\n          phone: that.data.phoneNumber || ''\n        })\n      }\n    }\n    app.wxrequest(getobj)\n  },\n  /**\n   * 生命周期函数--监听页面加载\n   */\n  onLoad (params) {\n    this.setData({\n      id: params.userId,\n      type: params.type || 's'\n    })\n    if (params.type === 'out') {\n      app.wxlogin(this.getUserDetail, params.userId)\n    } else {\n      this.getUserDetail(params.userId)\n    }\n  },\n  /**\n   * 生命周期函数--监听页面初次渲染完成\n   */\n  onReady () {\n    // TODO: onReady\n  },\n\n  /**\n   * 生命周期函数--监听页面显示\n   */\n  onShow () {\n    // console.log('asdf', app.getPhone(this))\n    // TODO: onShow\n  },\n\n  /**\n   * 生命周期函数--监听页面隐藏\n   */\n  onHide () {\n    // TODO: onHide\n  },\n\n  /**\n   * 生命周期函数--监听页面卸载\n   */\n  onUnload () {\n    // TODO: onUnload\n  },\n\n  /**\n   * 页面相关事件处理函数--监听用户下拉动作\n   */\n  // 下拉操作\n  onPullDownRefresh () {\n    // TODO: onPullDownRefresh\n    // wx.stopPullDownRefresh()\n    // this.playVideo()\n  },\n  // 上拉触底操作\n  onReachBottom () {\n    // todo 判断是否关注了\n    // if (!this.data.user.shenduziliao) {\n    //   return wx.showToast({\n    //     title: '约会成功才可查看对方深度资料'\n    //   })\n    // }\n    // this.setData({\n    //   showTaDeep: true,\n    //   showMoreBtn: false\n    // })\n  },\n  onShareAppMessage () {\n    this.setData({\n      type: 's'\n    })\n    return {\n      title: '有人要一起分享吗？',\n      path: `pages/userInfo/userInfo?userId=${this.data.id}&type=out`,\n      success () {\n        wx.reLaunch({\n          url: '../index2/index2'\n        })\n      }\n    }\n  }\n})\n"]}