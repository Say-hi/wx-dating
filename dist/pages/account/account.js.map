{"version":3,"sources":["pages/account/account.js"],"names":["app","getApp","useUrl","require","Page","data","title","shwoWhat","status","getUserMoney","that","moneyObj","url","payIndex","session_key","wx","getStorageSync","success","res","setData","sincerityMoney","bao_money","money","coin","is_back","wxrequest","mOp","e","currentTarget","dataset","type","backobj","userBondBack","wechat_no","wechat","code","showToast","message","mask","inputValue","detail","value","chargeBao","chargeObj","payByBond","yxObj","timeStamp","nonceStr","package","paySign","fail","wxpay","onLoad","onReady","onShow","onHide","onUnload","onPullDownRefresh"],"mappings":"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","file":"account.js","sourcesContent":["// 获取全局应用程序实例对象\nconst app = getApp()\nconst useUrl = require('../../utils/service')\n// 创建页面实例对象\nPage({\n  /**\n   * 页面的初始数据\n   */\n  data: {\n    title: 'account',\n    shwoWhat: 'detail',\n    status: 0\n  },\n  // 获取用户余额\n  getUserMoney () {\n    let that = this\n    let moneyObj = {\n      url: useUrl.payIndex,\n      data: {\n        session_key: wx.getStorageSync('session_key')\n      },\n      success (res) {\n        // console.log(res)\n        that.setData({\n          sincerityMoney: res.data.data.bao_money * 1,\n          money: res.data.data.coin,\n          status: res.data.data.is_back // 0 无 1有\n        })\n      }\n    }\n    app.wxrequest(moneyObj)\n  },\n  // 申请退款操作\n  mOp (e) {\n    let that = this\n    if (e.currentTarget.dataset.type === 'confirm') {\n      // if (!this.data.wechat) {\n      //   return wx.showToast({\n      //     title: '请输入您的微信号码'\n      //   })\n      // }\n      let backobj = {\n        url: useUrl.userBondBack,\n        data: {\n          session_key: wx.getStorageSync('session_key'),\n          wechat_no: that.data.wechat || '未填写'\n        },\n        success (res) {\n          if (res.data.code === 400) {\n            return wx.showToast({\n              title: res.data.message\n            })\n          }\n          wx.showToast({\n            title: res.data.message\n          })\n          that.setData({\n            mask: false\n          })\n          that.getUserMoney()\n        }\n      }\n      app.wxrequest(backobj)\n    } else {\n      this.setData({\n        mask: false\n      })\n    }\n  },\n  // 文字输入\n  inputValue (e) {\n    this.setData({\n      wechat: e.detail.value\n    })\n  },\n  // 充值保证金\n  chargeBao () {\n    let that = this\n    if (this.data.status * 1 === 1) {\n      return wx.showToast({\n        title: '审核中...'\n      })\n    }\n    if (this.data.sincerityMoney) {\n      return that.setData({\n        mask: true\n      })\n    }\n    let chargeObj = {\n      url: useUrl.payByBond,\n      data: {\n        session_key: wx.getStorageSync('session_key')\n      },\n      success (res) {\n        let yxObj = {\n          timeStamp: res.data.data.timeStamp,\n          nonceStr: res.data.data.nonceStr,\n          package: res.data.data.package,\n          paySign: res.data.data.paySign,\n          success (res) {\n            // 支付成功\n            wx.showToast({\n              title: '保证金充值成功',\n              mask: true\n            })\n            that.getUserMoney()\n          },\n          fail (res) {\n            // 支付失败\n            wx.showToast({\n              title: '充值失败，请再次尝试',\n              mask: true\n            })\n          }\n        }\n        app.wxpay(yxObj)\n      }\n    }\n    app.wxrequest(chargeObj)\n  },\n  /**\n   * 生命周期函数--监听页面加载\n   */\n  onLoad () {\n    // TODO: onLoad\n  },\n\n  /**\n   * 生命周期函数--监听页面初次渲染完成\n   */\n  onReady () {\n    // TODO: onReady\n  },\n\n  /**\n   * 生命周期函数--监听页面显示\n   */\n  onShow () {\n    this.getUserMoney()\n    // TODO: onShow\n  },\n\n  /**\n   * 生命周期函数--监听页面隐藏\n   */\n  onHide () {\n    // TODO: onHide\n  },\n\n  /**\n   * 生命周期函数--监听页面卸载\n   */\n  onUnload () {\n    // TODO: onUnload\n  },\n\n  /**\n   * 页面相关事件处理函数--监听用户下拉动作\n   */\n  onPullDownRefresh () {\n    // TODO: onPullDownRefresh\n  }\n})\n"]}